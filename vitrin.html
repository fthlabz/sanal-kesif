<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sanal KeÅŸif | Premium Vitrin</title>
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.4.0/model-viewer.min.js"></script>
    <style>
        :root {
            --glass-bg: rgba(255, 255, 255, 0.85);
            --accent: #007aff;
            --dark: #1a1a1a;
        }

        body { margin: 0; overflow: hidden; font-family: '-apple-system', sans-serif; background: #f0f2f5; }
        
        model-viewer { width: 100vw; height: 100vh; background-color: #f0f2f5; outline: none; }

        /* Ãœst Panel (V-Card ÅžÄ±klÄ±ÄŸÄ±nda) */
        .top-nav {
            position: absolute; top: 20px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 450px;
            background: var(--glass-bg); backdrop-filter: blur(15px);
            padding: 15px 20px; border-radius: 25px;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1); border: 1px solid rgba(255,255,255,0.3);
            z-index: 100;
        }

        .nav-circle {
            width: 45px; height: 45px; background: white; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            border: none; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            transition: 0.3s;
        }
        .nav-circle:active { transform: scale(0.9); background: #eee; }

        .info-center { text-align: center; flex-grow: 1; }
        .info-center h3 { margin: 0; font-size: 16px; font-weight: 800; color: var(--dark); }
        .info-center p { margin: 2px 0 0 0; font-size: 13px; font-weight: 600; color: var(--accent); }

        /* AR Butonu (Premium Apple TarzÄ±) */
        .premium-ar-btn {
            position: absolute; bottom: 40px; left: 50%; transform: translateX(-50%);
            background: var(--dark); color: white; border: none;
            padding: 18px 40px; border-radius: 35px;
            font-size: 17px; font-weight: 700; cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            display: flex; align-items: center; gap: 12px;
            width: 85%; max-width: 380px; justify-content: center;
            z-index: 100;
        }

        /* HalÄ± Hizalama UyarÄ±sÄ± (Senin isteÄŸin Ã¼zerine) */
        #hint-box {
            position: absolute; top: 110px; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.7); color: white; padding: 10px 20px;
            border-radius: 15px; font-size: 12px; font-weight: 500;
            text-align: center; width: 70%; max-width: 300px;
            pointer-events: none; opacity: 0; transition: 0.5s; z-index: 90;
        }

        /* YÃ¼kleme EkranÄ± */
        #loader {
            position: absolute; inset: 0; background: #f0f2f5;
            display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 200;
        }
        .dot-spinner { width: 40px; height: 40px; border: 4px solid #ddd; border-top: 4px solid var(--accent); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div id="loader">
        <div class="dot-spinner"></div>
        <p style="margin-top:15px; font-weight:700; color:#666">HalÄ± Dokunuyor...</p>
    </div>

    <div id="hint-box">ðŸ’¡ HalÄ± uÃ§uyor gibi gÃ¶rÃ¼nÃ¼rse parmaÄŸÄ±nÄ±zla yere doÄŸru sÃ¼rÃ¼kleyip sabitleyebilirsiniz.</div>

    <model-viewer id="rugViewer"
        src="https://cdn.jsdelivr.net/gh/KhronosGroup/glTF-Sample-Models@master/2.0/BoxTextured/glTF-Binary/BoxTextured.glb"
        ar ar-modes="webxr scene-viewer quick-look"
        camera-controls shadow-intensity="1.2" auto-rotate exposure="0.8">
        
        <button slot="ar-button" class="premium-ar-btn" onclick="showHint()">
            <span>ðŸ”³</span> Evimde GÃ¶r (KamerayÄ± AÃ§)
        </button>
    </model-viewer>

    <div class="top-nav">
        <button class="nav-circle" onclick="degistir(-1)">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="3"><polyline points="15 18 9 12 15 6"></polyline></svg>
        </button>
        
        <div class="info-center">
            <h3 id="uAd">YÃ¼kleniyor...</h3>
            <p id="uOlcu">LÃ¼tfen Bekleyin</p>
        </div>

        <button class="nav-circle" onclick="degistir(1)">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="3"><polyline points="9 18 15 12 9 6"></polyline></svg>
        </button>
    </div>

    <script>
        // --- SENÄ°N BÄ°LGÄ°LERÄ°N ---
        const KULLANICI = "fthlabz";
        const REPO = "sanal-kesif";

        let vitrin = [];
        let aktifIndex = 0;
        const mv = document.getElementById('rugViewer');

        // 1. JSON DEFTERÄ°NÄ° GITHUB'DAN OKU (3 resim burasÄ± sayesinde gelecek)
        async function vitriniGetir() {
            try {
                const cevap = await fetch(`https://raw.githubusercontent.com/${KULLANICI}/${REPO}/main/vitrin.json?t=${Date.now()}`);
                if (cevap.ok) {
                    vitrin = await cevap.json();
                    haliyiBas(0);
                }
            } catch (e) { console.error("JSON okuma hatasÄ±"); }
        }

        async function haliyiBas(index) {
            if (vitrin.length === 0) return;
            
            document.getElementById('loader').style.display = 'flex';
            const urun = vitrin[index];
            document.getElementById('uAd').innerText = `Model ${index + 1} / ${vitrin.length}`;
            document.getElementById('uOlcu').innerText = `${urun.en} x ${urun.boy} cm`;

            mv.scale = `${urun.en / 100} 0.01 ${urun.boy / 100}`;

            try {
                // Safari engelini aÅŸan doÄŸrudan doku yÃ¼kleme
                const texture = await mv.createTexture(urun.url);
                const material = mv.model.materials[0];
                material.pbrMetallicRoughness.baseColorTexture.setTexture(texture);
                material.pbrMetallicRoughness.setBaseColorFactor([1, 1, 1, 1]);
                document.getElementById('loader').style.display = 'none';
            } catch (error) { 
                console.log("Doku yÃ¼klenemedi");
                document.getElementById('loader').style.display = 'none';
            }
        }

        window.degistir = function(yon) {
            aktifIndex += yon;
            if (aktifIndex >= vitrin.length) aktifIndex = 0;
            if (aktifIndex < 0) aktifIndex = vitrin.length - 1;
            haliyiBas(aktifIndex);
        }

        function showHint() {
            const hint = document.getElementById('hint-box');
            hint.style.opacity = "1";
            setTimeout(() => { hint.style.opacity = "0"; }, 5000);
        }

        mv.addEventListener('load', vitriniGetir);
    </script>
</body>
</html>
